~~~ cs
#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/DeclareDepthTexture.hlsl"


half4 FragAfterOpaque(Varyings input) : SV_Target
{
    UNITY_SETUP_STEREO_EYE_INDEX_POST_VERTEX(input);

    // 获取屏幕空间AO
    AmbientOcclusionFactor aoFactor = GetScreenSpaceAmbientOcclusion(input.uv);
    half occlusion = aoFactor.indirectAmbientOcclusion;
    
    // 获取当前像素的深度并转换为线性眼空间深度（世界单位）
    float depth = SampleSceneDepth(input.uv);
    float linearDepth = LinearEyeDepth(depth, _ZBufferParams); // 使用LinearEyeDepth获取世界单位深度
    
    // 计算线性衰减因子（类似雾气衰减）
    // float distanceFade = 1.0 - smoothstep(_AONearFadeStart, _AOFarFadeEnd, linearDepth);
    
    float distanceFade = saturate(( linearDepth -_AONearFadeStart ) / (_AOFarFadeEnd - _AONearFadeStart));

    // 应用衰减
    occlusion = saturate(saturate(occlusion) + distanceFade*2) ;
    // occlusion= saturate(occlusion+0.5);
    // return   half4(occlusion.xxx,1);
    return half4(0.0, 0.0, 0.0, occlusion);
}
~~~