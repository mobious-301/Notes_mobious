import os
import uuid

def generate_cats_file_from_directory(directory_path, cats_file_path,root_display_name):
    """
    根据指定目录结构生成 blender_assets.cats 文件。
    
    :param directory_path: 要扫描的根目录路径
    :param cats_file_path: 输出的 blender_assets.cats 文件路径
    """
    entries = []

    def walk_directory(path, catalog_path_prefix="",root_display_name=""):
        for entry in os.scandir(path):
            if entry.is_dir():
                # 构建 Blender 中的 Catalog Path
                current_catalog_path = f"{catalog_path_prefix}/{entry.name}".strip("/")

                # 显示名（可自定义）
                display_name = entry.name

                # 生成唯一 UUID
                catalog_id = str(uuid.uuid4())

                # 添加到列表
                print(root_display_name)
                entries.append(f"{catalog_id}:{root_display_name}/{current_catalog_path}:{display_name}")

                # 递归处理子目录
                walk_directory(entry.path, current_catalog_path)

    # 开始遍历
    walk_directory(directory_path,root_display_name)

    # 写入文件
    with open(cats_file_path, 'w', encoding='utf-8') as f:
        f.write("# This is an Asset Catalog Definition file for Blender.\n")
        f.write("# Empty lines and lines starting with `#` will be ignored.\n")
        f.write("# The first non-ignored line should be the version indicator.\n")
        f.write("# Other lines are of the format \"UUID:catalog/path/for/assets:simple catalog name\"\n\n")
        f.write("VERSION 1\n\n")
        f.write("\n".join(entries))

    print(f"✅ 已成功生成 {cats_file_path}")


# 使用示例
directory_to_scan = "E:/八方_TGA/Game"         # 替换为你的目标目录路径
library_path = "D:/blenderA/Test"                   # 资产库根目录（要保存 .cats 文件的位置）
root_display_name = "OctopathTraveler2"           # 根目录的显示名称
cats_file_path = os.path.join(library_path, "blender_assets.cats.txt")  # 输出路径

generate_cats_file_from_directory(directory_to_scan, cats_file_path,root_display_name)



